# File: config.yaml
name: "School Chatbot WebSocket"
version: "1.0.15"
slug: school-chatbot-websocket
description: "AI Chatbot for schools with WebSocket support, music playback, and Azure AI"
arch:
  - amd64
  - armv7
  - aarch64
init: false
hassio_api: false
startup: application
boot: auto

ports:
  5000/tcp: 5000

options:
  # AI Provider
  ai_provider: deepseek
  
  # API Keys
  openai_api_key: ""
  openai_base_url: "https://api.openai.com/v1"
  deepseek_api_key: ""
  groq_api_key: ""
  
  # ✅ Azure OpenAI Configuration (no speech key needed)
  azure_api_key: ""
  azure_endpoint: ""
  azure_deployment: ""
  azure_api_version: "2024-02-15-preview"
  
  ai_model: "deepseek-chat"
  
  # TTS Provider
  tts_provider: openai
  tts_voice_vi: nova
  tts_voice_en: alloy
  
  # Piper voices
  piper_host: "addon_core_piper"
  piper_port: 10200
  piper_voice_vi: vi_VN-vais1000-medium
  piper_voice_en: en_US-lessac-medium
  tts_remove_emoji: true
  tts_remove_markdown: true

  # MySQL
  mysql_url: ""

  # Music Service
  music_service_url: "http://music.sfdp.net"
  enable_music_playback: true

  # Chat settings
  max_context: 10
  temperature: 0.7
  max_tokens: 500
  
  # System
  log_level: INFO

# ============================================================================
# SCHEMA (Validation + UI) - ✅ FIXED: Optional URL handling
# ============================================================================
schema:
  # === AI PROVIDER ===
  ai_provider: list(openai|deepseek|azure)
  ai_model: list(gpt-4o|gpt-4o-mini|gpt-4|gpt-4-turbo|gpt-3.5-turbo|deepseek-chat|deepseek-reasoner)
  
  # === API KEYS ===
  openai_api_key: password?
  openai_base_url: str?  # ✅ Changed from url? to str? to allow empty strings
  deepseek_api_key: password?
  groq_api_key: password?
  
  # === AZURE (no speech key needed) ===
  azure_api_key: password?
  azure_endpoint: str?  # ✅ Changed from url? to str? to allow empty strings
  azure_deployment: str?
  azure_api_version: str?
  
  # === TTS ===
  tts_provider: list(openai|piper)
  
  # OpenAI TTS voices
  tts_voice_vi: list(alloy|echo|fable|onyx|nova|shimmer)?
  tts_voice_en: list(alloy|echo|fable|onyx|nova|shimmer)?
  
  piper_host: str?
  piper_port: int(1,65535)?

  # Piper TTS voices
  piper_voice_vi: list(vi-25hours-single-low|vi-vivos-x-low|vi_VN-25hours_single-low|vi_VN-vais1000-medium|vi_VN-vivos-x_low)?
  piper_voice_en: list(en_US-lessac-medium|en_US-amy-medium|en_GB-alan-medium|en_GB-southern_english_female-medium)?

  tts_remove_emoji: bool?
  tts_remove_markdown: bool?

  # === PROMPTS ===
  system_prompt: str?
  custom_prompt: str?
  
  # === MYSQL ===
  mysql_url: str?  # ✅ Changed from url? to str? to allow empty strings
  
  # === MUSIC SERVICE ===
  music_service_url: str?  # ✅ Changed from url? to str? to allow empty strings
  enable_music_playback: bool?
  
  # === GENERAL ===
  temperature: float(0.0,2.0)?
  max_tokens: int(50,4000)?
  max_context: int(1,50)?
  max_context_messages: int(1,50)?
  log_level: list(DEBUG|INFO|WARNING|ERROR)?
